<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: scrollgame.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: scrollgame.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @function eventScrollGame
 * Mini-game portion of the game. Players collect objects
 * that belong to the biome and avoid ones that don't.
 */
var bgrnd;
function eventScrollGame() {
    /** standard canvas and stage variables */
    var canvas;
    var stage;
    /** background image*/
    var bg;
    /** keeps track of player score */
    var score;
    /** stores ship bitmaps */
    var bmpList = [];
    var bitmap;
    /** text display */
    var txt;
    // is the game currently in play?
    var play;
    /** game over text */
    var gameTxt;
    /** the mouse's current target */
    var mouseTarget;
    // is the mouse being clicked?
    var clicked;
    /** initializes the ship game */
	
	var difficulty = 1;
	/** difficulty of the minigame - 1 is easy, 3 is normal, 5 is hard 
		defaults to normal
		*/
    
    /**
     * @function onMouseDown
     * Handles a click down.
     */
    var onMouseDown = function(){
        if(!e){var e = window.event;}
        clicked = true;
    }
    /**
     * @function onMouseUp
     * Handles a click release.
     */
    var onMouseUp = function (){
        clicked = false
    }
    
    canvas = document.getElementById("main");
    //stage = new game.getStage();
    stage = new createjs.Container();
    score = 0;
    
    canvas.onmousedown = onMouseDown;
    canvas.onmouseup = onMouseUp;
    
    bg = new Image();
    bg.src = "rainforest.jpg";
    bg.onload = setBG;
    
    var toucan = new Image();
    toucan.src = "toucan.png";
    toucan.name = "toucan";
    toucan.onload = createAnimals;
    
    var sheep = new Image();
    sheep.src = "sheep.png";
    sheep.name = "sheep";
    sheep.onload = createAnimals;
	
	var start_contain = new createjs.Container();
   
    /**
     * @function setBG
     * Sets the background for the mini-game.
     */
    function setBG(event){
        bgrnd = new createjs.Bitmap(bg);
        game.getStage().addChild(bgrnd, stage);
		var start_text = new createjs.Text("Please select difficulty: \n", "32px Arial", "white");
		start_text.x = game.getStage().width/2 - 135;
		start_text.y = game.getStage().height/3 - 10;
		start_text.align = "center"
		var start_box = new createjs.Shape();
		start_box.graphics.beginFill("#212121").drawRect(canvas.width/2 - 185, canvas.height/3 - 15, 410, 170);
		var easy_button = new CircleButton("Easy", "24px Arial", 0, 0, "#00e676", game.getStage().width/2 - 120, game.getStage().height/3 + 80, 55, false, "#212121", "click", pick_easy);
		var med_button = new CircleButton("Medium", "24px Arial", 0, 0, "#ff9100", game.getStage().width/2 + 20, game.getStage().height/3 + 80, 55, false, "#212121", "click", pick_medium);
		var hard_button = new CircleButton("Hard", "24px Arial", 0, 0, "#00b0ff", game.getStage().width/2 + 160, game.getStage().height/3 + 80, 55, false, "212121", "click", pick_hard);
        start_contain.addChildAt(start_box, start_text, easy_button.container, med_button.container, hard_button.container, 0);
		stage.addChild(start_contain);
		game.getStage().update();
    }
	
	var anim_contain = new createjs.Container();
	
	function pick_easy () {
		difficulty = 1;
		play = true;
		stage.addChild(anim_contain);
		stage.removeChild(start_contain);
	}
	
	function pick_medium () {
		difficulty = 2;
		play = true;
		stage.addChild(anim_contain);
		stage.removeChild(start_contain);
	}
	
	function pick_hard () {
		difficulty = 4;
		play = true;
		stage.addChild(anim_contain);
		stage.removeChild(start_contain);
	}
    
    /**
     * @function createAnimals
     * Creates animal objects and enables clicking on them.
     */
	 
	 var anim_contain = new createjs.Container();
	 
    function createAnimals(event){
        var image = event.target;
		var l = 4;
        for (var i=0; i&lt;l; i++){
            bitmap = new createjs.Bitmap(image);
            anim_contain.addChild(bitmap);
            bitmap.name=image.name;
			resetAnimal(bitmap);
            bitmap.regX = bitmap.image.width/2|0;
            bitmap.regY = bitmap.image.height/2|0;
            bitmap.mouseEnabled = true;
            bmpList.push(bitmap);
        }
        
        
        createjs.Ticker.addEventListener("tick", tick);
    }
  
    /**
     * @function resetAnimal
     * Places animals randomly into the mini-game to be clicked/not clicked.
     */	 
    function resetAnimal(animal){
        animal.x = canvas.width + Math.random()*500;
        animal.y = canvas.height * Math.random()|0;
		// speed calculated based on difficulty setting - default is decently slow for younger kids (easy to tweak)
        animal.speed = (Math.random()*4)+ 2 + difficulty;
    }
    
    /**
     * @function tick
     * Ticker function for animation.
     */
    function tick(){
        /** check for clicking */
        if (!clicked &amp;&amp; game.getStage().mouseX &amp;&amp; game.getStage().mouseY){
            mouseTarget = game.getStage().getObjectUnderPoint(game.getStage().mouseX, game.getStage().mouseY);
        }
        if (clicked &amp;&amp; mouseTarget){
            var tempText = String(mouseTarget.name);
            if (tempText=="sheep" &amp;&amp; play == true){
                resetAnimal(mouseTarget);
                score-=50*difficulty;
                if (score &lt; 0){ /** prevent negative score */
                    score = 0;
                }
                clicked=false;
            }
            else if (tempText=="toucan"&amp;&amp; play == true){
                resetAnimal(mouseTarget);
                score+=50*difficulty;
                clicked=false;
            }
        }
        /** moving the animals */
        if (play == true){
            var l=bmpList.length;
            for(var i=0; i&lt;l; i++){
                var bmp = bmpList[i];
                if (bmp.x > -200){
                    bmp.x -= bmp.speed;
                }else{
                    if (bmp.name == "toucan"){
                        gameOver();
                        console.log("game over");
                    }
                    else{
                        resetAnimal(bmp);
                    }
                }
            }
        }
        //txt.text = "Score: "+score;
        game.getStage().update();
    }
    /**
     * @function gameOver
     * Ends game and displays "Game Over" text.
     */
    function gameOver(){
        stage.removeAllChildren();
		var scoreBox = new createjs.Shape();
		scoreBox.graphics.beginFill("#212121").drawRect(canvas.width/2 - 225, canvas.height/3 - 30, 450, 150);
		stage.addChild(scoreBox);
        gameTxt = new createjs.Text("Game Over\n", "36px Arial", "white");
		gameTxt.text += "Score: " + score + "\n";
        gameTxt.text += "Click to Try Another Biome\n";
        gameTxt.textAlign = "center";
        gameTxt.x = canvas.width/2;
        gameTxt.y = canvas.height/3;
        stage.addChild(gameTxt);
        play=false;
        var l=bmpList.length;
        for(var i=0; i&lt;l; i++){
            var bmp = bmpList[i];
            resetAnimal(bmp);
        }
        game.getStage().update();
        stage.on("click", function(event) {
            console.log("Clicked!");
            game.getStage().removeChild(stage);
            game.getStage().removeChild(bgrnd);
            game.progress();
        });
    }
    
    /**
     * @function handleClick
     * Handles a click after a game over
     */
    var handleClick = function(){
        canvas.onclick=null;
        stage.removeChild(gameTxt);
        score=0;
        
        play=true;
    }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addofclassDoublyLinkedCycle">add of class DoublyLinkedCycle</a></li><li><a href="global.html#CircleButton">CircleButton</a></li><li><a href="global.html#createAnimalsCreatesanimalobjectsandenablesclickingonthem.">createAnimalsCreates animal objects and enables clicking on them.</a></li><li><a href="global.html#DoublyLinkedCycleDoublyLinkedCycleclass,storinglength,head,andtail">DoublyLinkedCycle DoublyLinkedCycle class, storing length, head, and tail</a></li><li><a href="global.html#eventAddItemSectiontoadditemstothegame.">eventAddItem Section to add items to the game.</a></li><li><a href="global.html#eventEditItemsectiontoedittheitemsalreadyinthegame.">eventEditItem section to edit the items already in the game.</a></li><li><a href="global.html#eventInfoScreenInfoScreenportionofthegame.Displaysobjectsthatbelonginthebiome.Scrolloverobjectsforinformation.">eventInfoScreenInfo Screen portion of the game. Displays objects that belong in the biome.Scroll over objects for information.</a></li><li><a href="global.html#eventLoadMapUtilizesthemanifesttopreloadassetsinto">eventLoadMapUtilizes the manifest to preload assets into</a></li><li><a href="global.html#eventMoveAroundEarthAllowsplayertopickabiometovisit.">eventMoveAroundEarthAllows player to pick a biome to visit.</a></li><li><a href="global.html#eventPreloadAssetsUtilizesthemanifesttopreloadassetsinto">eventPreloadAssetsUtilizes the manifest to preload assets into</a></li><li><a href="global.html#eventScavengerHuntItemgatheringportionofgame.">eventScavengerHuntItem gathering portion of game.</a></li><li><a href="global.html#eventScrollGameMini-gameportionofthegame.Playerscollectobjectsthatbelongtothebiomeandavoidonesthatdon't.">eventScrollGameMini-game portion of the game. Players collect objectsthat belong to the biome and avoid ones that don't.</a></li><li><a href="global.html#eventStartMenu">eventStartMenu</a></li><li><a href="global.html#finishPrivatefunctioncalledbyGame.progress()whentheendofthegameisreachedDoanythingtofinishthegamesuchasannouncethewinner,releaseresources,askifthey'dliketoplayagain,changegraphics,etc...">finishPrivate function called by Game.progress() when the end of the game is reachedDo anything to finish the game such as announce the winner, releaseresources, ask if they'd like to play again, change graphics, etc...</a></li><li><a href="global.html#four_player">four_player</a></li><li><a href="global.html#GameThisisacontainerforasingle-player(fornow),linearstorybasedgame.Agameisseenasaseriesof%2522GameEvents,%2522representedbytheGameEventobject.EachGameEventhastwofunctionpointers,moveFuncandactionFunc.ThefirstismeanttohandlethetransitionbetweenthelastGameEventandthecurrentone.Thesecondismeanttosetupwhatactuallyhappensatthispointinthegame.ThisincludesrenderingshapesandsettingupEventListenersforuserinteraction.Meaning,whatactuallymakesthegameuniqueistheseriesofGameEventsandthecodetheirfunctionpointerspointto.TocreatecustomGameEventobjectsandaddthemtothesequenceofevents,createapriviledgedmemberclass(reallyafunctionobj)toGame.loadStory.Thisobjectshouldcontainconstructorcode,whichwillbetriggeredwhenitisthecurrentGameEvent;eventListenersforuserinteractionandgameprogression,andanyotherdatamembersneededtodowhatyouwantatthatpointinthegame.AlleventListenersshouldbepublicfunctionssuchthatCreateJScanlaunchthem.Now,toassignoneormoreGameEvent'sfunctionpointerstopointtothisnewfunctionobject,simplymaketheassignmentinthebodyofGame.loadStory().Asimpleexampleisprovided.EachGameEventwillhavetotriggerGame.progress()atsomepoint(mostlikelyalistenerfunction)toconcludethecurrentGameEventandtriggerthenextone.ThiswillcontinueuntiltherearenomoreGameEventobjects.PopulateGame.start()andGame.finish()withcodetohandlethebeginningandendingofthegame.">GameThis is a container for a single-player (for now), linear story based game. A game is seen as a series of "Game Events," represented by the GameEvent object.Each GameEvent has two function pointers, moveFunc and actionFunc. The first is meant to handle the transition between the last GameEvent and the current one.The second is meant to setup what actually happens at this point in the game.This includes rendering shapes and setting up EventListeners for user interaction.Meaning, what actually makes the game unique is the series of GameEvents and the codetheir function pointers point to.To create custom GameEvent objects and add them to the sequence of events, createa priviledged member class (really a function obj) to Game.loadStory. This object shouldcontain constructor code, which will be triggered when it is the current GameEvent; eventListeners for user interaction and game progression, and any other data members needed  to dowhat you want at that point in the game. All eventListeners should be public functions such thatCreateJS can launch them.Now, to assign one or more GameEvent's function pointers to point to this new function object,simply make the assignment in the body of Game.loadStory(). A simple example is provided.Each GameEvent will have to trigger Game.progress() at some point (most likely a listener function)to conclude the current GameEvent and trigger the next one. This will continue until there are nomore GameEvent objects. Populate Game.start() and Game.finish() with code to handlethe beginning and ending of the game.</a></li><li><a href="global.html#GAME_WIDTH">GAME_WIDTH</a></li><li><a href="global.html#GameEventAnabstractrepresentationofaneventwithinagame.Thiscouldbeaspotontheboard,aseguetoanotherpartofagame,ananimation,mini-game,etc...">GameEventAn abstract representation of an event within a game. This could be a spot on theboard, a segue to another part of a game, an animation, mini-game, etc...</a></li><li><a href="global.html#gameOverEndsgameanddisplays%2522GameOver%2522text.">gameOverEnds game and displays "Game Over" text.</a></li><li><a href="global.html#handleClickHandlesaclickafteragameover">handleClickHandles a click after a game over</a></li><li><a href="global.html#handleCompleteCallsgame.progress()onceloadingiscomplete.">handleCompleteCalls game.progress() once loading is complete.</a></li><li><a href="global.html#handleErrorLogsanerroriftheloadingfails.">handleErrorLogs an error if the loading fails.</a></li><li><a href="global.html#handleFileErrorLogsanerrorifanindividualfileloadfails.">handleFileErrorLogs an error if an individual file load fails.</a></li><li><a href="global.html#handleFileLoadStoresassetinarrayonceloaded.">handleFileLoadStores asset in array once loaded.</a></li><li><a href="global.html#handleFileProgressDisplaysloadingprogressfortotalloading.">handleFileProgressDisplays loading progress for total loading.</a></li><li><a href="global.html#handleItemProgressDisplaysloadingprogressforfilesthattakelongertoload.">handleItemProgressDisplays loading progress for files that take longer to load.</a></li><li><a href="global.html#initInitializesthegameandhidestheDescriptiondiv.">init Initializes the game and hides the Description div.</a></li><li><a href="global.html#Node">Node</a></li><li><a href="global.html#numPlayers">numPlayers</a></li><li><a href="global.html#on1">on1</a></li><li><a href="global.html#on2">on2</a></li><li><a href="global.html#on3">on3</a></li><li><a href="global.html#on4">on4</a></li><li><a href="global.html#on5">on5</a></li><li><a href="global.html#one_player">one_player</a></li><li><a href="global.html#onInfoOKFunctionthathandleswhenOKisclickedontheInfoPage.RemovestheinfoPagecontainerandcallsgame.progress()">onInfoOKFunction that handles when OK is clicked on the Info Page.Removes the infoPage container and calls game.progress()</a></li><li><a href="global.html#onMouseDownHandlesaclickdown.">onMouseDownHandles a click down.</a></li><li><a href="global.html#onMouseUpHandlesaclickrelease.">onMouseUpHandles a click release.</a></li><li><a href="global.html#onStartHandleuserclicking%2522start%2522">onStartHandle user clicking "start"</a></li><li><a href="global.html#options_menu">options_menu</a></li><li><a href="global.html#PlayerRepresentsaplayerinthegame">PlayerRepresents a player in the game</a></li><li><a href="global.html#RectButton">RectButton</a></li><li><a href="global.html#resetAnimalPlacesanimalsrandomlyintothemini-gametobeclicked/notclicked.">resetAnimalPlaces animals randomly into the mini-game to be clicked/not clicked.</a></li><li><a href="global.html#setBGSetsthebackgroundforthemini-game.">setBGSets the background for the mini-game.</a></li><li><a href="global.html#this.getCanvasReturnsareferencetotheunderlyingcanvas">this.getCanvasReturns a reference to the underlying canvas</a></li><li><a href="global.html#this.getCurrentEventReturnsareferencetothecurrentGameEventobject">this.getCurrentEvent  Returns a reference to the current GameEvent object</a></li><li><a href="global.html#this.getCurrentPlayerReceiveareferencetotheplayerwho'sturnitcurrentlyis">this.getCurrentPlayerReceive a reference to the player who's turn it currently is</a></li><li><a href="global.html#this.getIconGetareferencetothePlayer'sEaselJSShapeobject">this.getIconGet a reference to the Player's EaselJS Shape object</a></li><li><a href="global.html#this.getIconGetvisualrepresentationoftheGameEvent,ifany">this.getIconGet visual representation of the GameEvent, if any</a></li><li><a href="global.html#this.getStageGetrootEaselJSDisplayObjectobjectofthegame">this.getStageGet root EaselJS DisplayObject object of the game</a></li><li><a href="global.html#this.globalDataAgenericcontainerforgame-scopedata.Meaning,ifitisneededthroughoutdifferentpartsofthegame,putithere.Ifthedataisneededforonlyonesegment(i.e.,GameEvent),bundleitwiththeobjectpointedtobytheGameEvent'smoveFunc()oractionFunc()member.">this.globalDataA generic container for game-scope data. Meaning, if it is neededthroughout different parts of the game, put it here. If the data isneeded for only one segment (i.e., GameEvent), bundle it with the object pointed toby the GameEvent's moveFunc() or actionFunc() member.</a></li><li><a href="global.html#this.handleDblClickExtendedfunctionthathandlesdoubleclickingontheplayerbyproceedingwiththescavengerhuntportionofthegame.">this.handleDblClickExtended function that handles double clicking on the player by proceeding with the scavenger hunt portion of the game.</a></li><li><a href="global.html#this.loadStoryAssignsGameEventobjectstheircustomcode">this.loadStory Assigns GameEvent objects their custom code</a></li><li><a href="global.html#this.onOK2ExtendedfunctionthathandleswhenItemInfoOK2isclickedbymovingthedefaulthighlighted/selectedoptiontothefirstbuttonstillavailableifthereareremainingitemsorbyremovingtheinfoContainerandcallinggame.progress().">this.onOK2Extended function that handles when Item Info OK2 is clicked by moving the default highlighted/selected option to the first button still available if there are remaining items or by removing the infoContainer and calling game.progress().</a></li><li><a href="global.html#this.onOKExtendedfunctionthathandleswhenscavengerhuntOKisclickedbydisplayingthecorrespondingiteminfoandremovingtheselecteditemfromavailableoptions.">this.onOKExtended function that handles when scavenger hunt OK is clicked by displaying the corresponding item info and removing the selected item from available options.</a></li><li><a href="global.html#this.onOKExtendedfunctionthathandleswhenselectCategoryOKisclicked.Thefirsttimeitisclicked,itwillstoretheselectedoptionandthenchangetheoptionstobiomes.Thesecondtimeitisclicked,itwillaccesstherelativeinformationbasedonethetwocategoryselections.">this.onOKExtended function that handles when selectCategoryOK is clicked. The first time it is clicked, it will store the selected option and then change the options to biomes. The second time it is clicked, it will access the relative information based one the two category selections.</a></li><li><a href="global.html#this.progressThisisthemostimportantfunction.CallingthistransitionstothenextGameEvent.">this.progressThis is the most important function.Calling this transitions to the next GameEvent.</a></li><li><a href="global.html#this.setIconSetareferencetothePlayer'sEaselJSShapeobject">this.setIconSet a reference to the Player's EaselJS Shape object</a></li><li><a href="global.html#this.setIconSetvisualrepresentationoftheGameEvent,ifany">this.setIconSet visual representation of the GameEvent, if any</a></li><li><a href="global.html#this.setStageSetrootEaselJSDisplayObjectobjectofthegame">this.setStageSet root EaselJS DisplayObject object of the game</a></li><li><a href="global.html#this.startCalledtostartthegame.Shouldinitializeandrenderanythingneededtostartthegame.Willreturnwith-1forerrorifaeaselJSstagehasn'tbeenprovidedusingGame.setStage(Stage)">this.startCalled to start the game. Should initialize and render anything needed to startthe game. Will return with -1 for error if a easelJS stage hasn'tbeen provided using Game.setStage(Stage)</a></li><li><a href="global.html#this.transitionMovesfromoneGameEventtotheother,simplytakesawayoldeventListeners">this.transitionMoves from one GameEvent to the other, simply takes away old eventListeners</a></li><li><a href="global.html#this.triggerExecutethecodepointedtobymoveFuncandactionFunc">this.triggerExecute the code pointed to by moveFunc and actionFunc</a></li><li><a href="global.html#this.updateGamePositionProvideanupdatedboardpositiontotheplayer.">this.updateGamePositionProvide an updated board position to the player.</a></li><li><a href="global.html#three_player">three_player</a></li><li><a href="global.html#tickTickerfunctionforanimation.">tickTicker function for animation.</a></li><li><a href="global.html#two_player">two_player</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Wed Jan 25 2017 05:38:00 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
